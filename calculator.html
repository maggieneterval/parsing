<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Browserception</title>
  <link rel="stylesheet" media="all" href="./node_modules/mocha/mocha.css">
</head>
<body>
  <div id="mocha"><p><a href=".">Index</a></p></div>
  <div id="messages"></div>
  <div id="fixtures"></div>
  <script src="./node_modules/mocha/mocha.js"></script>
  <script src="./node_modules/chai/chai.js"></script>
  <script>mocha.setup('bdd'); var expect = chai.expect;</script>

  <!-- CODE -->
  <script>
    function calc(expr) {

        var expressionToParse = expr.replace(/\s+/g, '').split('');
        
        function peek() {
            return expressionToParse[0] || '';
        }
        
        function get() {
            return expressionToParse.shift();
        }
        
        /*
          Grammar Rule:
          number = [0-9] {[0-9.]+}

          Hint: remember this means we need to get the first number
            followed by any number of numbers (or the period .)

         */
        function number() {
        }
        

        /* Grammar Rule:
          factor = number
                  | "(" expression ")"
                  | - factor

          Hints:
            - If we see a number, produce a number 
            - If we see a (  then consume it and an expression
            - If we see a "-", return the negative of the factor
         */
        function factor() {
        }
        



        /*
          term = factor {(*|/) factor}
         */
        function term() {
        }

        /* Grammar Rules
            expression = term {(+|-) term}
        */
        function expression() {
            var result = term();
            while (peek() == '+' || peek() == '-') {
                if (get() == '+') {
                    result += term();
                } else {
                    result -= term();
                }
            }
            return result;
        }

        return expression();
    }
  </script>
  <!-- TESTS -->

  <script>
  describe("calculator", function() {
          
    it("can parse a a single digit number", function() {
        expect(calc("4")).to.eql(4);
    })
          
    it("can parse a number without a decimal", function() {
        expect(calc("428")).to.eql(428);
    })
      
    it("can parse a number with a decimal", function() {
        expect(calc("428.27")).to.eql(428.27);
    })
      
    it("can handle addition of two numbers", function() {
      expect(calc("1+2")).to.eql(3);
    });
    
    it("can handle subtraction of two numbers", function() {
      expect(calc("4-2")).to.eql(2);
    });
    
    it("handles any number of addition and subtraction statements", function() {
      expect(calc("4+2+1-2+2")).to.eql(7);
    });

    it("handles multiplication statements", function() {
      expect(calc("2*3")).to.eql(6);
    })

    it("handles division statements", function() {
      expect(calc("8/2)")).to.eql(4);
    }) 
    
    it("handles any number of multiplication statements", function() {
      expect(calc("5*3*4*8*2")).to.eql(960);
    })
    
    it("handles any number of division statements", function() {
      expect(calc("(100/2/5/5")).to.eql(2);
    })
    
    it("handles a math expression with parentheses", function() {
      expect(calc("(5-3*4)")).to.eql(-7);
    })    

    it("handles more complication mathmatical expressions", function() {
      expect(calc("(5 - (3 + (2 * 2 / 2) *(4 / 2)))")).to.eql(-2);
    })    
  });
  </script>
  <script>mocha.run();</script>

</body>
</html>
